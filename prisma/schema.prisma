generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String   @id @default(uuid())
  socketId String   @unique
  username String
  roomId   String
  created  DateTime @default(now())
  color    String
  isAdmin  Boolean? @default(false)
  Room     Room     @relation(fields: [roomId], references: [id])

  @@map("users")
}

model Room {
  id                         String                      @id @default(uuid())
  name                       String
  host                       String
  inviteCode                 String?
  passcode                   String?
  currentVideoUrl            String?
  currentQueueIndex          Int
  maxRoomSize                Int
  created                    DateTime                    @default(now())
  previouslyConnectedMembers PreviouslyConnectedMember[]
  members                    User[]
  queue                      VideoQueueItem[]

  @@map("rooms")
}

model VideoQueueItem {
  id        String @id @default(uuid())
  title     String
  url       String
  thumbnail String
  roomId    String
  Room      Room   @relation(fields: [roomId], references: [id])

  @@map("video_queue_items")
}

model PreviouslyConnectedMember {
  userId   String  @id
  username String
  roomId   String?
  Room     Room?   @relation(fields: [roomId], references: [id])

  @@map("previously_connected_members")
}
